<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Internal Report</title>
  <style>
    body { font-family: Arial, Helvetica, sans-serif; margin: 20px; color: #222; }
    .header { display:flex; align-items:center; justify-content:space-between; margin-bottom: 12px; }
    .title  { font-size: 22px; font-weight: 700; }
    .pill   { display:inline-block; padding:4px 8px; border-radius: 999px; background:#ecfeff; color:#155e75; font-weight:600; font-size:12px; }
    h2 { font-size: 16px; margin: 22px 0 8px; }
    h3 { font-size: 14px; margin: 16px 0 6px; }
    table { width: 100%; border-collapse: collapse; margin-top: 6px; }
    th, td { border: 1px solid #eee; padding: 6px 8px; font-size: 12px; text-align: left; }
    th { background: #f8fafc; }
    .star { color: #ef4444; font-weight: bold; }
    .subtle { color:#666; font-size: 12px; }
    .section { margin-bottom: 16px; }
  </style>
</head>
<body>
  <div class="header">
    <div class="title">Internal Report</div>
    <div class="pill">{{ report.executive_summary.label_A }} vs {{ report.executive_summary.label_B }}</div>
  </div>

  <h2>Executive Summary</h2>
  <table>
    <thead>
      <tr><th>Metric</th><th>A</th><th>B</th><th>Change</th></tr>
    </thead>
    <tbody>
      {% for m in report.executive_summary.metrics %}
        <tr>
          <td>{{ m.name }}</td>
          <td>{{ m.A_txt }}</td>
          <td>{{ m.B_txt }}</td>
          <td>{{ m.change }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>

  {% for section, rows in report.tables.items() %}
    <div class="section">
      <h2>{{ section|capitalize }}</h2>
      <table>
        <thead>
          <tr>
            <th>Name</th>
            <th>Loads A</th>
            <th>Loads B</th>
            <th>Core OR A</th>
            <th>Core OR B</th>
            <th>Δ Loads</th>
            <th>Impact S</th>
            <th>Impact D (000s)</th>
            <th>Dollarized S (000s)</th>
            <th>Composite (000s)</th>
            <th>Story</th>
          </tr>
        </thead>
        <tbody>
          {% for r in rows %}
            <tr>
              <td>{{ r.name }}</td>
              <td>{{ r.loads_A }}</td>
              <td>{{ r.loads_B }}</td>
              <td>{{ r.core_or_A_txt }}</td>
              <td>{{ r.core_or_B_txt }}</td>
              <td>{{ r.d_loads }}</td>
              <td>{{ "%.2f"|format(r.impact_s) }}</td>
              <td>{{ "%.2f"|format(r.impact_d_000s) }}</td>
              <td>{{ "%.2f"|format(r.dollarized_s_000s) }}</td>
              <td>{{ "%.2f"|format(r.composite_000s) }}</td>
              <td>{% if r.star %}<span class="star">★</span>{% endif %}</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  {% endfor %}

  <div class="subtle">* Asterisk on Core OR means substitution against network for that period.</div>
</body>
</html>